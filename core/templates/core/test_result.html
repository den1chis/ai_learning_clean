{% extends "core/base.html" %}
{% block content %}
<div class="relative hero min-h-screen overflow-hidden">
  <canvas id="ai-canvas" class="absolute inset-0 w-full h-full z-0"></canvas>

  <div class="relative z-10 max-w-md mx-auto p-6 bg-[#1e293b]/60 border border-gray-700 rounded-xl shadow-lg text-center text-white space-y-6 mt-12">

    <h2 class="text-2xl font-bold">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞</h2>

    <div class="space-y-1">
      <p class="text-lg">üéØ –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å:</p>
      <h3 class="text-xl font-semibold">{{ rec_module.title }}</h3>
      <p class="text-gray-400">{{ rec_module.description|truncatechars:120 }}</p>
    </div>

    {% if demo_info %}
      <div class="bg-gray-800/50 p-4 rounded-lg text-left space-y-2 text-sm">
        <h4 class="text-white font-semibold mb-1">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–æ–¥—É–ª—è–º:</h4>
        <ul class="space-y-1">
          {% for info in demo_info %}
            <li class="flex justify-between">
              <span>{{ info.module.title }}</span>
              <span>{{ info.count }}/5 ({{ info.percent }}%)</span>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <a href="{% url 'dashboard' %}"
       class="mt-4 inline-block bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-xl">
      –í –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
    </a>
  </div>
</div>
{% endblock %}

{% block scripts %}
{{ block.super }}
<script>
document.addEventListener("DOMContentLoaded", function () {
    const canvas = document.getElementById("ai-canvas");
    const ctx = canvas.getContext("2d");
    const hero = document.querySelector(".hero");

    function resizeCanvas() {
        canvas.width = hero.offsetWidth;
        canvas.height = hero.offsetHeight;
    }

    resizeCanvas();
    window.addEventListener("resize", resizeCanvas);

    const particles = [];
    const numParticles = 60;
    const maxDistance = 100;
    let mouse = { x: null, y: null };

    class Particle {
        constructor() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height;
            this.vx = (Math.random() - 0.5) * 1.2;
            this.vy = (Math.random() - 0.5) * 1.2;
            this.size = 1 + Math.random();
        }
        update() {
            this.x += this.vx;
            this.y += this.vy;
            if (this.x <= 0 || this.x >= canvas.width) this.vx *= -1;
            if (this.y <= 0 || this.y >= canvas.height) this.vy *= -1;
        }
        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fillStyle = "#00ffff";
            ctx.fill();
        }
    }

    function connectParticles() {
        for (let i = 0; i < particles.length; i++) {
            for (let j = i + 1; j < particles.length; j++) {
                const dx = particles[i].x - particles[j].x;
                const dy = particles[i].y - particles[j].y;
                const dist = Math.hypot(dx, dy);
                if (dist < maxDistance) {
                    ctx.beginPath();
                    ctx.strokeStyle = `rgba(255,255,255,${1 - dist / maxDistance})`;
                    ctx.moveTo(particles[i].x, particles[i].y);
                    ctx.lineTo(particles[j].x, particles[j].y);
                    ctx.stroke();
                }
            }
            if (mouse.x !== null && mouse.y !== null) {
                const dx = particles[i].x - mouse.x;
                const dy = particles[i].y - mouse.y;
                const dist = Math.hypot(dx, dy);
                if (dist < 120) {
                    ctx.beginPath();
                    ctx.strokeStyle = "rgba(0,255,255,0.3)";
                    ctx.moveTo(particles[i].x, particles[i].y);
                    ctx.lineTo(mouse.x, mouse.y);
                    ctx.stroke();
                }
            }
        }
    }

    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => { p.update(); p.draw(); });
        connectParticles();
        requestAnimationFrame(animate);
    }

    for (let i = 0; i < numParticles; i++) {
        particles.push(new Particle());
    }

    window.addEventListener("mousemove", function (e) {
        const rect = canvas.getBoundingClientRect();
        mouse.x = e.clientX - rect.left;
        mouse.y = e.clientY - rect.top;
    });

    window.addEventListener("mouseout", function () {
        mouse.x = null;
        mouse.y = null;
    });

    animate();
});
</script>
{% endblock %}
